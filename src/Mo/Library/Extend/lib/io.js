var $io=(function(){var a={};a.is=function(b){if(b.length<2){return false}return b.substr(1,1)==":"};a.fso=F.fso||F.activex("scripting.filesystemobject");a.stream=function(d,b){var c=F.activex("adodb.stream");c.mode=d||3;c.type=b||1;return c};a.fps=[];a.absolute=function(b){b=F.mappath(b);return a.fso.GetAbsolutePathName(b)};a.base=function(b){b=F.mappath(b);return a.fso.GetBaseName(b)};a.parent=function(b){return a.fso.GetParentFolderName(F.mappath(b))};a.build=function(c,b){return a.fso.GetAbsolutePathName(a.fso.BuildPath(F.mappath(c),b))};a.get=function(b){b=F.mappath(b);var c=null;if(a.file.exists(b)){c=a.fso.getFile(b)}else{if(a.directory.exists(b)){c=a.fso.getFolder(b)}}if(c==null){ExceptionManager.put(11550,"io.get","file or directory is not exists.");return{}}return{attr:c.Attributes,toString:function(){return a.attr.toString(c.Attributes)},date:{created:c.DateCreated,accessed:c.DateLastAccessed,modified:c.DateLastModified},name:c.Name,path:c.Path,size:c.Size,type:c.Type,src:c}};a.attr=function(e,d){var c=a.get(e);if(!c.hasOwnProperty("src")){return -1}if(d!==undefined){if(d&8||d&16||d&64||d&128){ExceptionManager.put(11533,"io.attr","attributes value error.");return -1}return c.src.Attributes=d}else{return c.src.Attributes}};a.attr.add=function(e,d){var c=a.get(e);if(!c.hasOwnProperty("src")){return -1}if(!(c.src.Attributes&d)){return c.src.Attributes|=d}return -1};a.attr.remove=function(e,d){var c=a.get(e);if(!c.hasOwnProperty("src")){return -1}if(c.src.Attributes&d){return c.src.Attributes^=d}return -1};a.attr.toString=function(b){var d="";if(b>0){for(var c in a.attrs){if(!a.attrs.hasOwnProperty(c)){continue}if(b&a.attrs[c]){d+=c+", "}}if(d!=""){d=d.substr(0,d.length-2)}}else{d="Normal"}return d};return a})();$io.file=$io.file||(function(){var a={};var b=function(c,d){a.write(c,d);a.flush(c);a.close(c)};a.get=function(c){var d=null;c=F.mappath(c);if($io.fso.fileexists(c)){d=$io.fso.getFile(c)}else{ExceptionManager.put(11550,"io.file.get","file is not exists.")}return d};a.exists=function(c){c=F.mappath(c);return $io.fso.fileexists(c)};a.del=function(d){if(!a.exists(d)){return true}try{$io.fso.deletefile(F.mappath(d));return true}catch(c){ExceptionManager.put(c,"io.file.del");return false}};a.copy=function(e,c){try{$io.fso.CopyFile(e,c)}catch(d){ExceptionManager.put(d,"io.file.copy");return false}};a.move=function(e,c){try{$io.fso.MoveFile(e,c)}catch(d){ExceptionManager.put(d,"io.file.move");return false}};a.readAllText=function(f,e){var c=$io.file.open(f,{forText:true,forRead:true,encoding:e||"utf-8"});var d=$io.file.read(c);$io.file.close(c);return d};a.readAllScript=function(f,e){var c=$io.file.open(f,{forText:true,forRead:true,encoding:e||"utf-8"});var d=$io.file.read(c);$io.file.close(c);return d.replace(new RegExp("^(\\s*)<script(.+?)>(\\s*)","i"),"").replace(new RegExp("(\\s*)<\\/script>(\\s*)$","i"),"")};a.readAllBytes=function(e){var c=$io.file.open(e,{forText:false,forRead:true});var d=$io.file.read(c);$io.file.close(c);return d};a.writeAllBytes=function(d,c){b(a.open(d,{forText:false}),c)};a.writeAllText=function(e,d,c){b(a.open(e,{encoding:c||"utf-8"}),d)};a.appendAllBytes=function(d,c){b(a.open(d,{forText:false,forAppend:true}),c)};a.appendAllText=function(e,d,c){b(a.open(e,{encoding:c||"utf-8",forAppend:true}),d)};a.open=function(f,e){f=F.mappath(f);var c={forAppend:false,forText:true,forRead:false,encoding:"utf-8"};F.extend(c,e||{});var d=$io.stream(3,c.forText?2:1);if(c.forText){d.charset=c.encoding}d.open();if(a.exists(f)&&(c.forAppend||c.forRead)){d.loadfromfile(f);if(c.forAppend){d.position=d.size}}$io.fps.push([d,f,c]);return $io.fps.length-1};a.seek=function(d,c){if(!$io.fps[d]){ExceptionManager.put(11566,"io.file.seek","file resource id is invalid.");return}$io.fps[d][0].position=c};a.write=function(c,e){if(!$io.fps[c]){ExceptionManager.put(11582,"io.file.write","file resource id is invalid.");return}try{if($io.fps[c][2].forText){$io.fps[c][0].writeText(e)}else{$io.fps[c][0].write(e)}}catch(d){ExceptionManager.put(d,"io.file.write")}};a.read=function(c,d){if(!$io.fps[c]){ExceptionManager.put(11598,"io.file.read","file resource id is invalid.");return null}if($io.fps[c][2].forText){if(d){return $io.fps[c][0].readText(d)}return $io.fps[c][0].readText()}else{if(d){return $io.fps[c][0].read(d)}return $io.fps[c][0].read()}};a.flush=function(c){if(!$io.fps[c]){ExceptionManager.put(11614,"io.file.flush","file resource id is invalid.");return}c=$io.fps[c];try{c[0].flush();c[0].saveToFile(c[1],2)}catch(d){ExceptionManager.put(d,"io.file.flush['"+F.string.right(c[1],"\\")+"']")}};a.close=function(c){if(!$io.fps[c]){ExceptionManager.put(11630,"io.file.close","file resource id is invalid.");return}$io.fps[c][0].close()};a.extension=function(c){return $io.fso.GetExtensionName(F.mappath(c))};return a})();$io.directory=$io.directory||(function(){var a={};a.get=function(b){var c=null;if($io.fso.folderexists(b)){c=$io.fso.getFolder(b)}else{ExceptionManager.put(11550,"io.directory.get","directory is not exists.")}return c};a.exists=function(b){b=F.mappath(b);return $io.fso.folderexists(b)};a.del=function(c){if(!a.exists(c)){return true}try{$io.fso.deletefolder(F.mappath(c));return true}catch(b){ExceptionManager.put(b,"io.directory.del");return false}};a.copy=function(d,b){try{$io.fso.CopyFolder(d,b)}catch(c){ExceptionManager.put(c,"io.directory.copy");return false}};a.move=function(d,b){try{$io.fso.MoveFolder(d,b)}catch(c){ExceptionManager.put(c,"io.directory.move");return false}};a.create=function(d){d=F.mappath(d);if(a.exists(d)){return true}var c=$io.fso.GetParentFolderName(d);if(!a.exists(c)){a.create(c)}try{$io.fso.CreateFolder(d);return true}catch(b){ExceptionManager.put(b,"io.directory.create");return false}};a.clear=function(e,c){e=F.mappath(e);var d=(typeof c=="function");if(!a.exists(e)){return false}try{a.files(e,function(g){if(d){if(c(g,true)!==false){g.Delete()}}else{g.Delete()}});a.directories(e,function(g){if(d){if(c(g,false)!==false){g.Delete()}}else{g.Delete()}});return true}catch(b){ExceptionManager.put(b,"io.directory.clear");return false}};a.files=function(e,f){if(!a.exists(e)){return[]}var c=[];e=F.mappath(e);var b=new Enumerator($io.fso.getFolder(e).files);var d=(typeof f=="function");for(;!b.atEnd();b.moveNext()){if(d){f(b.item())}else{c.push(b.item().path)}}return c};a.directories=function(e,f){if(!a.exists(e)){return[]}var c=[];e=F.mappath(e);var b=new Enumerator($io.fso.getFolder(e).subfolders);var d=(typeof f=="function");for(;!b.atEnd();b.moveNext()){if(d){f(b.item())}else{c.push(b.item().path)}}return c};a.windows=$io.fso.GetSpecialFolder(0);a.system=$io.fso.GetSpecialFolder(1);a.temp=$io.fso.GetSpecialFolder(2);return a})();$io.drive=$io.drive||function(b){b=F.mappath(b);var a=$io.fso.GetDrive($io.fso.GetDriveName(b));return{space:{available:a.AvailableSpace,free:a.FreeSpace,total:a.TotalSize},letter:a.DriveLetter,type:a.DriveType,typeString:$io.drive.types[a.DriveType]||"Unknown",fileSystem:a.FileSystem,isReady:a.IsReady,path:a.Path,sn:(a.SerialNumber<0?(a.SerialNumber+4294967296):a.SerialNumber).toString(16)}};$io.drive.types=["Unknown","Removable","Fixed","Network","CDROM","RAM"];$io.attrs={Normal:0,ReadOnly:1,Hidden:2,System:4,Volume:8,Directory:16,Archive:32,Alias:64,Compressed:128};$io.directory.attr=$io.file.attr=$io.attr;$io.directory.base=$io.file.base=$io.base;$io.directory.absolute=$io.file.absolute=$io.absolute;$io.directory.parent=$io.file.parent=$io.parent;module.exports=$io;